ASF Threshold Change Detection Product
======================================

This folder contains the files generated by the Alaska Satellite Facility (ASF) for the Change Detection - Threshold product using HyP3 Threshold Change Detection software version [HYP3_VER] running GAMMA release [GAMMA_VER]. The pixel spacing is [SPACING] m.

The source granules for this change detection product are:
 - Reference (D1): [REF_NAME]
 - Secondary (D2): [SEC_NAME]

Processing Date/Time: [DATE] [TIME] UTC

****************
__The product folder is named using the following convention:__

S1xy_aaaaaaaaTbbbbbb_ggggggggThhhhhh_pp_qqqqqq_rrrd_tcd  
x:      	Sentinel-1 Mission (A or B) of reference (D1) granule  
y:      	Sentinel-1 Mission (A or B) of secondary (D2) granule  
aaaaaaaa:      	Start Date of Acquisition (YYYYMMDD) of reference granule  
bbbbbb:      	Start Time of Acquisition (HHMMSS) of reference granule  
gggggggg:      	Start Date of Acquisition (YYYYMMDD) of secondary granule  
hhhhhh:      	Start Time of Acquisition (HHMMSS) of secondary granule  
pp:      	Polarization Type (SH: Single HH, SV: Single VV, DH: Dual HH+HV, DV: Dual VV+VH)  
qqqqqq:      	Orbit ephemerides file type (POEORB: Precise, RESORB: Restituted, ORBPRE: Predicted)  
rrrd:      	Time separation in days (d) between reference and secondary granules  
tcd:      	Threshold Change Detection Product

__The change detection files within the folder are named using the following convention:__

change_PP_aaaaaaaaTbbbbbb_ggggggggThhhhhh_suffix
PP:      	Polarization (VV, VH, HV, HH)
aaaaaaaa:      	Start Date of Acquisition (YYYYMMDD) of reference granule  
bbbbbb:      	Start Time of Acquisition (HHMMSS) of reference granule  
gggggggg:      	Start Date of Acquisition (YYYYMMDD) of secondary granule  
hhhhhh:      	Start Time of Acquisition (HHMMSS) of secondary granule  
suffix:      	File-specific tags, as described below in the product content details	      		

----------------
The Threshold Change Detection process calculates the log difference between two Radiometric Terrain Corrected (RTC) images acquired over the same area and applies a threshold to highlight areas with significant differences in radar backscatter between the two acquisition dates.

HyP3 users can either select two granules to compare and run them using a One-Time Processing order, or generate a Subscription. For subscriptions, the next-nearest and second-nearest date pairs are processed for each path/frame covered by the subscription parameters.

----------------
### To cite the data: ###
ASF DAAC [YEARPROCESSED] using GAMMA software. Contains modified Copernicus Sentinel data [YEARACQUIRED], processed by ESA.

----------------
Visit the GAMMA Remote Sensing website for more information about GAMMA SAR Software:
https://www.gamma-rs.ch

----------------
*Consider opening this document in a Markdown editor/viewer for easier reading.*


****************
# Product Contents #

The files generated in this process include:  

1. RTC GeoTIFFs for each source granule for each polarization  
2. Log Difference GeoTIFF for each polarization  
3. Color-symbolized Threshold Change Images (PNG format) 
4. Integer Threshold Change Images (PNG format) 
5. Threshold Change KMZ files

**See below for detailed descriptions of each of the product files.**

----------------
## 1. RTC GeoTIFFs

The Threshold Change Detection product calculates the log difference between two Radiometric Terrain Corrected (RTC) images. The RTC images are generated from the source granules using GAMMA software, and output in gamma-0 amplitude with an Enhanced Lee filter applied. The RTC GeoTIFFs are included in this package for reference, and are named in the same manner as the products generated using the RTC - GAMMA process in HyP3:

S1x_yy_RTzz_aaaaaaaaTbbbbbb_c_def.tif  
x:        Sentinel-1 Mission (A or B)  
yy:       Beam Mode  
zz:       Terrain Correction Resolution  
aaaaaaaa: Start Date of Acquisition (YYYYMMDD)  
bbbbbb:   Start Time of Acquisition (HHMMSS)  
c:        Processor (Gamma or S1TBX)  
d:        gamma-0 (g) or sigma-0 (s) output  
e:        amplitude (a) or power (p) output  
f:        Not filtered (n) or Filtered (f)  

----------------
## 2. Log Difference GeoTIFFs

A log difference GeoTIFF is calculated for each polarization using the RTC images described above by applying the following formula to each pixel:  

Log10(D2/D1)  

where D1 is the granule with the earlier acquisition date, and D2 has the more recent acquisition date. 

Positive values indicate an increase in radar backscatter from the first date to the second, while negative values indicate a decrease. 

The filenames for the log difference GeoTIFFs do not have a suffix, but consist of the change detection product base file name with a .tif extension.

----------------
## 3. Color-symbolized Threshold Change Images

A threshold is applied to the change GeoTIFF to generate color PNG files. The threshold is set so that log difference pixel values between -0.25 and 0.25 are considered stable, log difference pixels with values lower than -0.25 indicate negative change (decreased radar backscatter), and log difference pixels with values higher than 0.25 indicate positive change (increased radar backscatter). 

Pixels that undergo a negative change from the first date to the second (decrease in backscatter returns, giving a darker appearance) are displayed in red, while those displaying a positive change (increase in backscatter returns, giving a brighter appearance) are displayed in blue. 

There is a color PNG image tagged _thresh_rgb_full.png for each available polarization. This image is at the same resolution as the Log Difference GeoTIFF.

Color browse images in PNG format are also generated for each available polarization. The PNG browse images are available in two different resolutions: the file  tagged _thresh_rgb.png is a small browse image (1024 pixels wide), while the file tagged _thresh_rgb_large.png is of higher resolution (2048 pixels wide). 

No Data pixels, which include both the pixels with values between -0.25 and 0.25 and any pixels padding the edges of the raster, are mapped to 0 in all three RGB channels. While many image viewers and GIS software packages are set to treat these pixels as NoData and display them as transparent, these pixels will appear black if this is not the case. Explore your display options to change this setting if desired.

When viewing the PNG images in ArcGIS, the software default is to stretch the values to a percent clip and apply a gamma stretch. To view the colors at their most vivid, right click the browse image in the ArcMap table of contents and select Properties. Under the Symbology tab, select Minimum-Maximum for the Stretch Type, and uncheck the box next to the Apply Gamma Stretch option.

Each PNG file has a corresponding aux.xml file, which contains the georeferencing information. This file must be present in the same directory as the associated PNG file in order to view the projected image in a GIS.

*Note that the -0.25 to 0.25 cutoff is somewhat arbitrary, and may not represent your situation well if you are looking for more subtle changes or want to identify only extreme changes. You can choose a custom threshold, or even multiple thresholds, within a GIS environment by applying a Classified symbology to a Log Difference GeoTIFF and setting the threshold values to better reflect your particular use case. Contact ASF if you need assistance applying a custom threshold to the Log Difference GeoTIFFs.*

----------------
## 4. Integer Threshold Change Images

A full-resolution single-band PNG image is also included for each available polarization. Rather than RGB values, the threshold areas of change are indicated by integer values. Negative change has a pixel value of 64 and positive change has a pixel value of 193. The integer values make this raster easier to use for raster calculations than the RGB rasters. You can reclassify this raster to set the default pixel values to values that best facilitate your analysis.

In an image viewer, the negative change pixels will generally be displayed as black and the positive change pixels as grey. In ArcGIS, the values may have a Percent Clip stretch applied, which displays the negative change pixels in grey and the positive change pixels as white; to differentiate the white pixels from the NoData pixels, consider changing the stretch to Min-Max with no gamma stretch and a Red to Blue color ramp, or using the Discrete Color symbology option with a Red to Blue color ramp and the number of colors set to 2.

Each PNG file has a corresponding aux.xml file, which contains the georeferencing information. This file must be present in the same directory as the associated PNG file in order to view the projected image in a GIS.

----------------
## 5. Threshold Change KMZ file

A Threshold Change KMZ file is generated for each available polarization. The color scheme is the same as the PNG files, and the images are 2048 pixels wide.


****************
# Threshold Change Detection Processing #

The basic steps in processing the Threshold Change Detection products are as follows: 

*RTC Processing*
1.  Data granule is ingested into gamma format - calibration is done during this step.  
2.  If required, data is multi-looked to the desired number of looks (default for 30-m products is 6 looks for GRD granules and 3 for SLC; 10-m products default to one look). This product used [LOOKS] look(s).  
3.  An Enhanced Lee speckle filter is applied.
4.  A DEM is extracted from the ASF DEM heap covering the granule to be corrected.  
5.  A mapping function is created, mapping from DEM space into SAR space.  
6.  A simulated SAR image is created.  
7.  The simulated SAR image and the real SAR image are coregistered.  
8.  The mapping function is updated with the coregistration information.  
9.  The SAR image is radiometrically corrected using a pixel integration approach to remove radiometric distortions in foreshortening or layover areas.  
10. The inversion of the mapping function is used to terrain correct and geocode the radiometrically corrected SAR image.  
11. Post processing creates GeoTIFFs in gamma-0 amplitude.  

*Change Detection Processing*
12. The log difference is calculated for the source imagery (Log10(D2/D1)).  
13. Threshold change TIFFs are generated by applying lower and upper thresholds to the log difference rasters.  
14. Browse images and KMZ files are generated from the threshold change GeoTIFF.


*************
# The Sentinel-1 mission #

The Sentinel-1 satellite constellation is part of the Copernicus Earth Observation program, coordinated by the European Space Agency (ESA) on behalf of the European Commission (EC). Sentinel-1 satellites carry C-band Synthetic Aperture Radar (SAR) instruments for global, around-the-clock imagery, even through cloud cover. The Sentinel-1A satellite was launched April 3, 2014, and the Sentinel-1B satellite was launched April 25, 2016. The satellites each have a 12-day repeat cycle, but are offset 180 degrees in order to repeat passes every 6 days. 

More information about the mission is available at:  
https://earth.esa.int/web/guest/missions/esa-operational-eo-missions/sentinel-1

Additional information about Sentinel-1 data, imagery, tools and applications is available at:  
https://asf.alaska.edu/data-sets/sar-data-sets/sentinel-1


*************
For assistance, contact the Alaska Satellite Facility:  
uso@asf.alaska.edu  
907-474-5041  

-------------
Revised 2020-03-25



